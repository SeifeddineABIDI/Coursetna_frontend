<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.5/css/dataTables.bootstrap5.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"> <!-- Include Font Awesome -->
</head>
<body>
    <!-- Modèle d'edit -->
    <div class="add-modal" *ngIf="showModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Question</h5>
                    <button type="button" class="btn-close" (click)="toggleModal(false)" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form [formGroup]="questionForm">
                        <div class="mb-3">
                            <label  class="form-label">Question</label>
                            <input type="text" class="form-control" placeholder="question" formControlName="question" >

                            <div class="form-error font-medium text-red-600 dark:text-red-500" *ngIf="questionForm.get('question')?.hasError('required') && questionForm.get('question')?.touched">
                                Question is required
                            </div>
                        </div>
                
                        <div class="mb-3">
                            <label  class="form-label">choice1</label>
                            <input type="text" class="form-control" placeholder="choice1" formControlName="choice1">
                            
                            <div class="form-error font-medium text-red-600 dark:text-red-500" *ngIf="questionForm.get('choice1')?.hasError('required') && questionForm.get('choice1')?.touched">
                                choice1 is required
                            </div>
                        </div>

                        <div class="mb-3">
                            <label  class="form-label">choice2</label>
                            <input type="text" class="form-control" placeholder="choice2" formControlName="choice2">
                            
                            <div class="form-error font-medium text-red-600 dark:text-red-500" *ngIf="questionForm.get('choice2')?.hasError('required') && questionForm.get('choice2')?.touched">
                                choice2 is required
                            </div>
                        </div>

                        <div class="mb-3">
                            <label  class="form-label">choice3</label>
                            <input type="text" class="form-control" placeholder="choice3" formControlName="choice3">
                            
                            <div class="form-error font-medium text-red-600 dark:text-red-500" *ngIf="questionForm.get('choice3')?.hasError('required') && questionForm.get('choice3')?.touched">
                                choice3 is required
                            </div>
                        </div>

                        <div class="mb-3">
                            <label  class="form-label">correctAnswer</label>
                            <input type="text" class="form-control" placeholder="correctAnswer" formControlName="correctAnswer">
                            
                            <div class="form-error font-medium text-red-600 dark:text-red-500" *ngIf="questionForm.get('correctAnswer')?.hasError('required') && questionForm.get('correctAnswer')?.touched">
                                correctAnswer is required
                            </div>
                        </div>

                        <div class="mb-3">
                            <label  class="form-label">points</label>
                            <input type="text" class="form-control" placeholder="points" formControlName="points">
                            
                            <div class="form-error font-medium text-red-600 dark:text-red-500" *ngIf="questionForm.get('points')?.hasError('required') && questionForm.get('points')?.touched">
                                points is required
                            </div>
                            <div class="form-error font-medium text-red-600 dark:text-red-500" *ngIf="questionForm.get('points')?.hasError('pattern') && questionForm.get('points')?.touched">
                                points must be number
                            </div>
                        </div>

                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" (click)="toggleModal(false)">Close</button>
                    <button type="submit" class="btn btn-primary" (click)="editQuestion()" [disabled]="questionForm.invalid">Save</button>
                </div>
            </div>
        </div>
    </div>
    <!-- end model d'edit -->


        <!-- Modèle de stat sur une question -->
        <div class="add-modal" *ngIf="showModalStat">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5>Statistique :</h5>
                        <button type="button" class="btn-close" (click)="toggleModalStat(false)" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>Total correct answers: {{ totalCorrectAnswers }}</p>
                    
                        <p>Total answers: {{ TotalAnswers }}</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" (click)="toggleModalStat(false)">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- end Modèle de stat sur une question -->


        <div class="flex flex-col flex-auto min-w-0">
            <!-- Header -->
           <div class="relative pt-4 pb-12 px-4 sm:pt-10 sm:pb-24 sm:px-16 overflow-hidden bg-gray-800 dark:bg-gray-900 dark">
             <!-- Background - @formatter:off -->
             <!-- Rings -->
             <svg class="absolute inset-0 pointer-events-none" viewBox="0 0 960 540" width="100%" height="100%"
                 preserveAspectRatio="xMidYMax slice" xmlns="http://www.w3.org/2000/svg">
                 <g class="text-gray-700 opacity-25" fill="none" stroke="currentColor" stroke-width="100">
                     <circle r="234" cx="196" cy="23"></circle>
                     <circle r="234" cx="790" cy="491"></circle>
                 </g>
             </svg>
             <!-- @formatter:on -->
             <div class="z-10 relative flex flex-col items-center">
                 <h2 class="text-lg font-semibold">Manage Your Questions</h2>
                 <div class="mt-1 text-2xl sm:text-4xl font-extrabold tracking-tight leading-tight text-center">
                    How can we help you today?
                 </div>             
             </div>
           </div>
        </div>

 <!-- Search input -->
 <div class="search-container">
    <input type="text" class="form-control short-input" placeholder="Search" [(ngModel)]="searchTerm">
</div>
          
    <!-- Tableau de données -->
    <table id="example" class="table table-striped custom-table">
        <thead>
            <tr>
                <th>Question</th>
                <th>Choices</th>
                <th>Correct</th>
                <th>Points</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody >
            <!-- Contenu de la table -->
            <tr *ngFor="let q of questions | filter: searchTerm">
                <td>{{q.question}}</td>
                <td><p>{{q.choice1}}</p><p>{{q.choice2}}</p><p>{{q.choice3}}</p></td>
                <td>{{q.correctAnswer}}</td>
                <td>{{q.points}}</td>
                <td>
                    
                    <button class="btn btn-primary" (click)="getTotalCorrectAnswersForQuestion(q.numQuestion)" ><i class="fas fa-info-circle"></i></button> <!-- Icône de modification -->
                    <button class="btn btn-primary" (click)="editModel(q)" ><i class="fas fa-edit"></i></button> <!-- Icône de modification -->
                    <button class="btn btn-danger" (click)="delQuestion(q.numQuestion)" ><i class="fas fa-trash-alt"></i></button> <!-- Icône de suppression -->
                </td>
            </tr>         
        </tbody>
    </table>


</body>
</html>
